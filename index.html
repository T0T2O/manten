<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>å‰²åˆãƒã‚¹ã‚¿ãƒ¼ï¼šç©¶æ¥µãƒ»å®Œå…¨ç‰ˆ</title>
    <style>
        :root { --main: #27ae60; --gold: #ffd700; --bg: #f4faf6; --line: #555; }
        body { font-family: sans-serif; text-align: center; background: var(--bg); padding: 10px; color: #333; }
        .box { background: white; max-width: 500px; margin: 0 auto; padding: 20px; border-radius: 20px; border: 4px solid var(--main); box-shadow: 0 8px 20px rgba(0,0,0,0.1); }
        .q-card { background: #fdfdfd; padding: 15px; border-radius: 12px; margin-bottom: 10px; font-weight: bold; border-bottom: 2px solid #eee; font-size: 1.1rem; line-height: 1.5; }
        .hint-text { background: #fffde7; color: #856404; padding: 10px; border-radius: 8px; font-size: 0.85rem; margin-bottom: 10px; border-left: 4px solid #fbc02d; text-align: left; }
        .diagram-area { background: #fff; border: 1px solid #ddd; border-radius: 10px; padding: 25px 10px; margin: 10px 0; cursor: pointer; position: relative; }
        .diagram-area:hover { border-color: var(--main); background: #f0fff4; }
        .line-container { position: relative; height: 50px; margin: 20px 0; }
        .base-line { position: absolute; left: 10%; right: 10%; height: 2px; background: var(--line); top: 50%; }
        .tick { position: absolute; width: 2px; height: 12px; background: var(--line); top: calc(50% - 6px); }
        .label { position: absolute; font-size: 0.75rem; width: 60px; text-align: center; left: -30px; }
        .val-top { top: -28px; font-weight: bold; color: #d35400; }
        .val-btm { bottom: -28px; }
        .btn { padding: 15px; width: 100%; background: var(--main); color: white; border: none; border-radius: 50px; font-size: 1.2rem; cursor: pointer; font-weight: bold; margin-top: 10px; box-shadow: 0 4px 0 #1e8449; }
        .btn:active { transform: translateY(4px); box-shadow: none; }
        input { font-size: 1.8rem; width: 140px; padding: 10px; border: 3px solid #ddd; border-radius: 15px; text-align: center; margin-bottom: 10px; }
        .explain-card { background: #fff1f0; border: 2px solid #ffa39e; border-radius: 15px; padding: 15px; margin-top: 15px; text-align: left; font-size: 0.9rem; line-height: 1.6; color: #222; }

        /* ã¬ã„ãã‚‹ã¿ãƒ–ãƒ­ãƒƒã‚³ãƒªãƒ¼å†ç¾ */
        #perfect-screen { position: fixed; top:0; left:0; width:100%; height:100%; background: radial-gradient(circle, #fff, #ffd700); display:none; flex-direction:column; align-items:center; justify-content:center; z-index:9999; }
        .broccoli-nuigurumi { width: 180px; height: 160px; position: relative; animation: bounce 0.6s infinite alternate; }
        .head-fluffy { width: 180px; height: 120px; background: #27ae60; border-radius: 40% 40% 30% 30%; position: relative; box-shadow: 0 0 25px rgba(255,215,0,0.8); }
        .face-body { width: 100px; height: 85px; background: #c1e1c1; border-radius: 35% 35% 50% 50%; margin: -45px auto 0; position: relative; }
        .eye { width: 10px; height: 10px; background: #222; border-radius: 50%; position: absolute; top: 35px; }
        .mouth { width: 12px; height: 6px; border-bottom: 3px solid #222; border-radius: 5px; position: absolute; top: 48px; left: 44px; }
        @keyframes bounce { from { transform: translateY(0); } to { transform: translateY(-40px); } }
    </style>
</head>
<body>

<div class="box" id="view">
    <h1 style="color:var(--main);">ğŸ¥¦ å‰²åˆãƒã‚¹ã‚¿ãƒ¼ ğŸ¥¦</h1>
    <p>10å•é€£ç¶šæ­£è§£ã§ç¥ãƒ–ãƒ­ãƒƒã‚³ãƒªãƒ¼ã«ä¼šãˆã‚‹ï¼</p>
    <button class="btn" onclick="start()">ã‚¹ã‚¿ãƒ¼ãƒˆï¼</button>
</div>

<div id="perfect-screen" onclick="location.reload()">
    <div class="broccoli-nuigurumi">
        <div class="head-fluffy"></div>
        <div class="face-body">
            <div class="eye" style="left:28px;"></div>
            <div class="eye" style="right:28px;"></div>
            <div class="mouth"></div>
        </div>
    </div>
    <h1 style="color:#b8860b; font-size:2.8rem; text-shadow:2px 2px white; margin:20px 0;">ç¥ é™ è‡¨</h1>
    <button class="btn" style="width:200px;">ä¼èª¬ã¸æˆ»ã‚‹</button>
</div>

<script>
let score = 0; let count = 0; let q = {}; let used = [];

const bank = [
    // æ•°ç›´ç·šã‚»ã‚¯ã‚·ãƒ§ãƒ³ (ãƒ†ã‚¹ãƒˆPDF 1, 4, 8ç•ªã®å†…å®¹ã‚’å…ƒã«ä½œæˆ)
    { type: "choice", t: "ã€Œ18LãŒ90%ã«ã‚ãŸã‚‹ã¨ãã€ã‚‚ã¨ã®ä½“ç©ã¯ï¼Ÿã€<br>æ­£ã—ã„å›³ã‚’é¸ã‚“ã§ï¼",
        opts: [{top:["0","18","[?]"],btm:["0","0.9","1"]},{top:["0","[?]","18"],btm:["0","0.9","1"]},{top:["0","18","1"],btm:["0","0.9","[?]"]}], a: 0,
        e: "1. 18LãŒ90%(0.9)ãªã®ã§ã€18ã¨0.9ãŒç¸¦ã«ä¸¦ã³ã¾ã™ã€‚<br>2. ã€ã‚‚ã¨ã€ã¯1(100%)ã®ã“ã¨ãªã®ã§ã€1ã®ä¸ŠãŒ[?]ã«ãªã‚Šã¾ã™ã€‚" },
    { type: "choice", t: "ã€Œ120gã®30%ã¯ä½•gï¼Ÿã€<br>æ­£ã—ã„å›³ã‚’é¸ã‚“ã§ï¼",
        opts: [{top:["0","[?]","120"],btm:["0","0.3","1"]},{top:["0","120","[?]"],btm:["0","0.3","1"]},{top:["0","30","120"],btm:["0","0.3","1"]}], a: 0,
        e: "1. ã€120gã®ã€ã¯ã€ã‚‚ã¨(1)ã€ã®ã“ã¨ãªã®ã§ã€120ã¨1ãŒç¸¦ã«ä¸¦ã³ã¾ã™ã€‚<br>2. æ±‚ã‚ã‚‹ã®ã¯ã€30%(0.3)ã€ã®é‡ãªã®ã§ã€0.3ã®ä¸ŠãŒ[?]ã§ã™ã€‚" },
    { type: "choice", t: "ã€Œ80kgã‚’ã‚‚ã¨ã«ã—ãŸ56kgã€ã®å›³ã¯ï¼Ÿ",
        opts: [{top:["0","56","80"],btm:["0","[?]","1"]},{top:["0","80","56"],btm:["0","[?]","1"]},{top:["0","56","1"],btm:["0","80","[?]"]}], a: 0,
        e: "1. 80kgãŒã€ã‚‚ã¨(1)ã€ã§ã™ã€‚<br>2. 56kgãŒæ¯”ã¹ã‚‰ã‚Œã‚‹é‡ãªã®ã§ã€å‰²åˆã¯[?]ã«ãªã‚Šã¾ã™ã€‚" },

    // è¨ˆç®—ã‚»ã‚¯ã‚·ãƒ§ãƒ³ (PDFè¡¨é¢ãƒ»è£é¢å…¨ç¯„å›²)
    { type: "num", t: "80kgã‚’ã‚‚ã¨ã«ã—ãŸ56kgã®å‰²åˆã¯ï¼Ÿ", a: 0.7, h: "56(ã) Ã· 80(ã‚‚) ã‚’è¨ˆç®—ï¼", e: "å¼ï¼š56 Ã· 80 = 0.7<br>ã€ã‚‚ã¨ã«ã™ã‚‹é‡ã€ã§å‰²ã‚‹ã®ãŒåŸºæœ¬ã§ã™ã€‚" },
    { type: "num", t: "20å›ä¸­16å›å‹ã£ãŸã€‚å‹ã£ãŸå‰²åˆã‚’ï¼…ã§ï¼", a: 80, h: "16 Ã· 20 ã‚’ã—ã¦100ã‚’ã‹ã‘ã‚‹ï¼", e: "16 Ã· 20 = 0.8<br>0.8ã¯80%ã®ã“ã¨ã§ã™ã€‚" },
    { type: "num", t: "21äººã¯15äººã®ä½•ï¼…ï¼Ÿ", a: 140, h: "21 Ã· 15 ã‚’è¨ˆç®—ï¼", e: "21 Ã· 15 = 1.4<br>1.4ã‚’ï¼…ã«ã™ã‚‹ã¨140%ã«ãªã‚Šã¾ã™ã€‚" },
    { type: "num", t: "ä»•å…¥ã‚Œå€¤2500å††ã«20ï¼…ã®åˆ©ç›Šã‚’ã®ã›ãŸå£²å€¤ã¯ï¼Ÿ", a: 3000, h: "1.2å€ã™ã‚‹ã‹ã€åˆ©ç›Šã‚’è¶³ãã†ï¼", e: "2500 Ã— 1.2 = 3000å††ã€‚<br>åˆ©ç›Šåˆ†ã¯500å††ã ã­ã€‚" },
    { type: "num", t: "å®šå“¡40äººã®130%ã®å¸Œæœ›è€…ãŒæ¥ãŸã€‚ä½•äººï¼Ÿ", a: 52, h: "40 Ã— 1.3 ã‚’è¨ˆç®—ï¼", e: "40 Ã— 1.3 = 52äºº<br>å®šå“¡ã‚’ã“ãˆã¦ã„ã‚‹ã®ãŒãƒã‚¤ãƒ³ãƒˆï¼" },
    { type: "num", t: "90ã¡ã®é¢ç©ã®ã†ã¡é‡èœç•‘ã¯27ã¡ã€‚ä½•ï¼…ï¼Ÿ", a: 30, h: "27 Ã· 90 ã‚’è¨ˆç®—ï¼", e: "27 Ã· 90 = 0.3<br>0.3ã¯30%ã§ã™ã€‚" },
    { type: "num", t: "æœ¬ã‚’72ãƒšãƒ¼ã‚¸èª­ã‚“ã ã€‚ã“ã‚Œã¯å…¨ä½“ã®60ï¼…ã€‚å…¨ä½“ã¯ä½•ãƒšãƒ¼ã‚¸ï¼Ÿ", a: 120, h: "72 Ã· 0.6 ã‚’è¨ˆç®—ï¼", e: "å¼ï¼š72 Ã· 0.6 = 120ãƒšãƒ¼ã‚¸ã€‚<br>ã‚‚ã¨ã®ãƒšãƒ¼ã‚¸æ•°ã¯72ã‚ˆã‚Šå¤šã„ã¯ãšï¼" },
    { type: "num", t: "600å††ã®30%å¼•ãã€‚å£²å€¤ã¯ä½•å††ï¼Ÿ", a: 420, h: "0.7(ã®ã“ã‚Šã®å‰²åˆ)ã‚’ã‹ã‘ã‚ˆã†ï¼", e: "600 Ã— 0.7 = 420å††ã€‚<br>å‰²å¼•é¡ã¯180å††ã§ã™ã€‚" },
    { type: "num", t: "0.06ã‚’ç™¾åˆ†ç‡ï¼ˆï¼…ï¼‰ã«ãªãŠã™ã¨ï¼Ÿ", a: 6, h: "100ã‚’ã‹ã‘ã‚ˆã†ï¼", e: "0.06 Ã— 100 = 6%" },
    { type: "num", t: "1.93ã‚’ç™¾åˆ†ç‡ï¼ˆï¼…ï¼‰ã«ãªãŠã™ã¨ï¼Ÿ", a: 193, h: "100ã‚’ã‹ã‘ã‚ˆã†ï¼", e: "1.93 Ã— 100 = 193%" },
    { type: "num", t: "46.2%ã‚’å°æ•°ã«ãªãŠã™ã¨ï¼Ÿ", a: 0.462, h: "100ã§ã‚ã‚ã†ï¼", e: "46.2 Ã· 100 = 0.462" },
    { type: "num", t: "150%ã‚’å°æ•°ã«ãªãŠã™ã¨ï¼Ÿ", a: 1.5, h: "100ã§ã‚ã‚ã†ï¼", e: "150 Ã· 100 = 1.5" },
    { type: "num", t: "15å›ä¸­6å›æˆåŠŸã—ãŸã‚·ãƒ¥ãƒ¼ãƒˆã®å‰²åˆã¯ï¼Ÿ(å°æ•°ã§)", a: 0.4, h: "6 Ã· 15 ã‚’è¨ˆç®—ï¼", e: "6 Ã· 15 = 0.4" },
    { type: "num", t: "20å›ä¸­8å›æˆåŠŸã—ãŸã‚·ãƒ¥ãƒ¼ãƒˆã®å‰²åˆã¯ï¼Ÿ(å°æ•°ã§)", a: 0.4, h: "8 Ã· 20 ã‚’è¨ˆç®—ï¼", e: "8 Ã· 20 = 0.4" },
    { type: "num", t: "13å›ä¸­4å›æˆåŠŸã—ãŸã‚·ãƒ¥ãƒ¼ãƒˆã®å‰²åˆã¯ï¼Ÿ(å°æ•°ç¬¬2ä½ã‚’å››æ¨äº”å…¥)", a: 0.3, h: "4 Ã· 13 ã‚’è¨ˆç®—ï¼", e: "4 Ã· 13 = 0.307... ãªã®ã§ç´„0.3ã§ã™ã€‚" },
    { type: "num", t: "600å††ã‹ã‚‰150å††å¼•ãã€‚å£²å€¤ã¯ä½•å††ï¼Ÿ", a: 450, h: "ãã®ã¾ã¾å¼•ãç®—ã—ã‚ˆã†ï¼", e: "600 - 150 = 450å††" },
    { type: "num", t: "ã‚‚ã¨ã®0.9å€ãŒ18Lã®ã¨ãã€ã‚‚ã¨ã¯ï¼Ÿ", a: 20, h: "18 Ã· 0.9 ã‚’è¨ˆç®—ï¼", e: "18 Ã· 0.9 = 20L" }
];

function start() { score = 0; count = 0; used = []; next(); }

function next() {
    let i; do { i = Math.floor(Math.random()*bank.length); } while(used.includes(i));
    used.push(i); q = bank[i];
    let html = `<div style="color:var(--main); font-weight:bold;">Lv.${count+1} / 10</div>`;
    html += `<div class="q-card">${q.t}</div>`;
    if(q.h) html += `<div class="hint-text">ğŸ’¡ <b>ãƒ’ãƒ³ãƒˆï¼š</b>${q.h}</div>`;
    
    if(q.type === "choice") {
        q.opts.forEach((opt, idx) => {
            html += `<div class="diagram-area" onclick="check(${idx})">
                <div class="line-container">
                    <div class="base-line"></div>
                    <div class="tick" style="left:10%;"></div><div class="label val-top" style="left:10%;">${opt.top[0]}</div>
                    <div class="tick" style="left:50%;"></div><div class="label val-top" style="left:50%;">${opt.top[1]}</div>
                    <div class="tick" style="left:90%;"></div><div class="label val-top" style="left:90%;">${opt.top[2]}</div>
                    <div class="label val-btm" style="left:10%;">${opt.btm[0]}</div>
                    <div class="label val-btm" style="left:50%;">${opt.btm[1]}</div>
                    <div class="label val-btm" style="left:90%;">${opt.btm[2]}</div>
                </div>
            </div>`;
        });
    } else {
        html += `<input type="number" id="ans" step="0.001" autofocus><br><button class="btn" onclick="checkNum()">ç­”ãˆåˆã‚ã›ï¼</button>`;
    }
    document.getElementById("view").innerHTML = html;
}

function check(idx) { result(idx === q.a); }
function checkNum() { result(Math.abs(parseFloat(document.getElementById("ans").value) - q.a) < 0.01); }

function result(isOk) {
    if(isOk) score++;
    let rHtml = isOk ? `<h2 style="color:var(--main)">âœ¨ æ­£è§£ï¼ãƒŠã‚¤ã‚¹ãƒ–ãƒ­ãƒƒã‚³ãƒªãƒ¼ï¼</h2>` : `<div class="explain-card"><b>âŒ è§£èª¬ï¼š</b><br>${q.e}</div>`;
    document.getElementById("view").innerHTML += rHtml;
    count++;
    const btnText = count < 10 ? "æ¬¡ã®å•é¡Œã¸" : "çµæœã‚’è¦‹ã‚‹";
    const func = count < 10 ? "next()" : "fin()";
    document.getElementById("view").innerHTML += `<button class="btn" style="background:#444;" onclick="${func}">${btnText}</button>`;
}

function fin() {
    if(score === 10) document.getElementById("perfect-screen").style.display = "flex";
    else document.getElementById("view").innerHTML = `<h2>ã—ã‚…ã†ã‚Šã‚‡ã†ï¼</h2><h1>${score} / 10</h1><p>å…¨å•æ­£è§£ã§ã€Œç¥ã€ã«ä¼šãˆã‚‹ãï¼</p><button class="btn" onclick="location.reload()">ãƒªãƒ™ãƒ³ã‚¸ã™ã‚‹ï¼</button>`;
}
</script>
</body>
</html>
